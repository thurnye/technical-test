<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Animated Butterflies</title>
    <style>
      body {
        margin: 0;
        overflow: hidden;
      }
      canvas {
        display: block;
      }
      #controls {
        position: fixed;
        top: 10px;
        left: 10px;
        background: rgba(255, 255, 255, 0.8);
        padding: 10px;
        border-radius: 8px;
        font-family: Arial, sans-serif;
      }
      label {
        display: block;
        margin-top: 6px;
      }
      input {
        width: 100%;
      }
    </style>
  </head>

  <body>
    <canvas id="butterflyCanvas"></canvas>
    <div id="controls" role="region" aria-label="Butterfly controls">
      <h2>Controls</h2>

      <label for="butterflyCount">Number of Butterflies:</label>
      <input type="number" id="butterflyCount" value="200" min="10" max="500" />

      <label for="speed">Speed:</label>
      <input
        type="number"
        id="speed"
        value="0.005"
        step="0.001"
        min="0.001"
        max="0.05"
      />

      <label for="color1">Color 1:</label>
      <input id="color1" type="color" value="#ff66cc" />

      <label for="color2">Color 2:</label>
      <input id="color2" type="color" value="#66ccff" />
    </div>

    <script>
      const canvas = document.getElementById("butterflyCanvas");
      const ctx = canvas.getContext("2d");
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;

      let butterflyCount = 200;
      let butterflies = [];
      const mouse = { x: canvas.width / 2, y: canvas.height / 2 };
      let gravity = 0.005;
      let color1 = "#ff66cc";
      let color2 = "#66ccff";
      let frame = 0;

      class Butterfly {
        constructor(x, y, size, speedX, speedY, color1, color2) {
          this.x = x;
          this.y = y;
          this.size = size;
          this.speedX = speedX;
          this.speedY = speedY;
          this.color1 = color1;
          this.color2 = color2;
          this.flapOffset = Math.random() * Math.PI * 2;
        }

        draw() {
          ctx.save();
          ctx.translate(this.x, this.y);
          const wingAngle = Math.sin(frame * 0.1 + this.flapOffset) * 0.5;

          // Body
          ctx.beginPath();
          ctx.fillStyle = "black";
          ctx.ellipse(0, 0, this.size * 0.1, this.size * 0.6, 0, 0, Math.PI * 2);
          ctx.fill();

          // Left wings
          this.drawWing(-wingAngle, -2, -1.2, this.color1); // upper
          this.drawWing(-wingAngle, -1.5, 1.8, this.color2); // lower

          // Right wings
          this.drawWing(wingAngle, 2, -1.2, this.color1); // upper
          this.drawWing(wingAngle, 1.5, 1.8, this.color2); // lower

          ctx.restore();
        }

        drawWing(angle, horiz, vert, color) {
          ctx.save();
          ctx.rotate(angle);
          ctx.beginPath();
          ctx.moveTo(0, 0);
          ctx.bezierCurveTo(
            this.size * horiz,
            this.size * vert,
            this.size * horiz,
            this.size * 0.8,
            0,
            0
          );
          ctx.fillStyle = color;
          ctx.fill();
          ctx.restore();
        }

        update() {
          const dx = mouse.x - this.x;
          const dy = mouse.y - this.y;
          const distance = Math.sqrt(dx * dx + dy * dy);

          if (distance > 1) {
            this.speedX += (dx / distance) * gravity;
            this.speedY += (dy / distance) * gravity;
          }

          const speed = Math.sqrt(this.speedX ** 2 + this.speedY ** 2);
          if (speed > 2) {
            this.speedX *= 2 / speed;
            this.speedY *= 2 / speed;
          }

          this.x += this.speedX;
          this.y += this.speedY;

          if (this.x > canvas.width || this.x < 0) this.speedX *= -1;
          if (this.y > canvas.height || this.y < 0) this.speedY *= -1;
        }
      }

      function createButterflies() {
        butterflies = [];
        for (let i = 0; i < butterflyCount; i++) {
          const size = Math.random() * 20 + 10; // Keep same design
          const x = Math.random() * canvas.width;
          const y = Math.random() * canvas.height;
          const speedX = (Math.random() - 0.5) * 2;
          const speedY = (Math.random() - 0.5) * 2;
          butterflies.push(
            new Butterfly(x, y, size, speedX, speedY, color1, color2)
          );
        }
      }

      function animate() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        butterflies.forEach((b) => {
          b.update();
          b.draw();
        });
        frame++;
        requestAnimationFrame(animate);
      }

      // Initial
      createButterflies();
      animate();

      // Controls
      document.getElementById("butterflyCount").addEventListener("input", (e) => {
        butterflyCount = parseInt(e.target.value);
        createButterflies();
      });

      document.getElementById("speed").addEventListener("input", (e) => {
        gravity = parseFloat(e.target.value);
      });

      document.getElementById("color1").addEventListener("input", (e) => {
        color1 = e.target.value;
        createButterflies();
      });

      document.getElementById("color2").addEventListener("input", (e) => {
        color2 = e.target.value;
        createButterflies();
      });

      // Resize & mouse
      window.addEventListener("resize", () => {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
      });

      window.addEventListener("mousemove", (e) => {
        mouse.x = e.clientX;
        mouse.y = e.clientY;
      });
    </script>
  </body>
</html>
